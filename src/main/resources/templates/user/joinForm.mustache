{{> /layout/header}}

<div class="container p-5">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- 요청을 하면 localhost:8080/join POST로 요청됨
    username=사용자입력값&password=사용자값&email=사용자입력값 -->

    <!--  View 에 input name값, action, method 확인-->

    <!--  html 파일에 name 값 있는지 확인하러 가기
    name이 없으면 데이터 전송이 안됨!!
    post 요청을 해야함. db변경 할꺼니까!!
    /join 식별자 요청  -->

    <div class="card">
        <div class="card-header"><b>회원가입을 해주세요</b></div>
        <div class="card-body">
            <form action="/join" method="post" enctype="application/x-www-form-urlencoded">
                <div class="mb-3">
                    <input id="username" type="text" class="form-control" placeholder="Enter username" name="username">
                    <button type="button" class="btn btn-danger" onclick="userSameCheck()">중복확인</button>
                </div>
                <div class="mb-3">
                    <input type="password" class="form-control" placeholder="Enter password" name="password">
                </div>
                <div class="mb-3">
                    <input type="email" class="form-control" placeholder="Enter email" name="email">
                </div>
                <button type="submit" class="btn btn-primary form-control">회원가입</button>
            </form>
        </div>
    </div>
</div>

<script>
    let isCheck = false;

    function userSameCheck() {
        let username = $("#username").val();
        console.log(username);
        $.ajax({
            url: "/api/username-same-check?username="+username,
            type: "get",
        }).done((res) => {
            console.log(res);
            if (res.body == false) {
                isCheck = true;
                alert("중복된 아이디가 없습니다");

            } else {
                isCheck = false;
                alert("아이디가 중복되었습니다.");
            }
        }).fail((res) => {
            alert(res.responseJSON.msg);
        });
    }


</script>
{{> /layout/footer}}